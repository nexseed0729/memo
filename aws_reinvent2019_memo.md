# 2020/2/6 AWS Re:Invent2019 recap
* speaker: 鮫島　正樹（機械学習ソリューションアーキテクト）

## AWSのMLスタック
- AIサービス（API系のサービス）
- MLサービス（機械学習のプロセス全体を効率化するマネージドサービス）
- MLフレームワークとインフラストラクチャ（機械学習の環境を自在に構築して利用）

## 各種サービス詳細
- Amazon Rekognition
    - 機械学習に基づく画像認識サービス
    - 去年までは，AWSが設定したものでしか認識できなかった
    - 今回: Amazon Rekognition Custom Labels
        - 独自の物体検出，シーン認識モデルを構築できる
        - 認識したい物体・シーンの画像をインポートして利用

- Amazon Polly
    - API経由でテキストを音声に変換
    - 日本語は合成型の text-to-speech に対応（やや不自然さが残る）

- Amazon Transcribe
    - オーディオファイルを解析し，音声をテキストに変換
    - 全ての単語にタイムスタンプを付与
    - 対応言語：日本語，米国英語，標準中国語，スペイン語など
    - 固有名詞などはカスタム語彙を追加することで対応可能

- Amazon Transcribe Medical
    - 医療向けに特化したもの

- Amazon Comprehend
    - テキストを解析するサービス
    - テキスト内でインサイトや関係性を検出するサービス
    - キーフレーズ抽出，感情分析
    - 構文解析，エンティティ認識（固有名詞や場所，とか）
    - 対応言語：日本語，英語，フランス語，ドイツ語，イタリア語，ポルトガル語，スペイン語
    - リージョン：現状東京は非対応

- Amazon Translate
    - サポートされている言語間でテキストを翻訳するためのNMT（ニューラル機械翻訳）
    - カスタム語彙を追加できる

- Amazon Textract
    - OCRサービス
    - pdf，画像のテキストと構造情報を抽出するマネージドサービス
    - テキスト，フォーム，テーブルの抽出が可能
    - 日本語には現在対応していない（英字のみ対応）
    - ユースケース
        - ドキュメントやフォームの情報をアプリケーションに取り込む
        - テキスト検索のインデックス作成
        - ドキュメントのコンプライアンスチェック
        - ドキュメントの自動処理ワークフロー
        - ドキュメントの分類のためのテキスト抽出
        - 自然言語処理のためのテキスト抽出

- Amazon Kendra
    - 機械学習を利用した高精度な文書検索
         - 自然分の質問に対応する回答の検索
         - 関連文書をランキング表示
    - コネクタを利用して様々なデータソースを取り込むことが可能
    - 学習なしでIT，金融，保険など，各業種の文章に対応（追加学習も対応予定）
    - 対応言語： 米国英語のみ
    - リージョン: バージニア，オレゴン，アイルランド
    - S3やFile Systems（SMB）などいろいろなコネクタに対応している
    - 利用開始方法：インデックスを作成 -> データソースを保存 -> テストとデプロイ

- Amazon Lex
    - チャットボットを簡単に構築できるサービス
    - 現在は英語のみに対応
    - こういう質問がきたらこう回答するといったようなルールづけができる

- Amazon Personalize
    - ユーザー向けにパーソナライズしたレコメンデーションをするための機械学習サービス
        - この商品を買った人はこんなものも買っています
    - Amazon.comと同様の技術を幅広い対象に対して適用できる
    - ユーザー向けにパーソナライズされたレコメンデーションリストの提供
    - この商品を購入した方はといった特定のアイテムに対する類似アイテムリストの提供
    - S3のユーザーデータに対してのバッチ推論も可能（たとえば，レコメンドをメール配信とかもできるようになった）

- Amazon Forecast
    - 過去の履歴から将来を予測する時系列データ予測サービス
    - Amazon.comと同様の技術で，様々なドメインに対応可能で，長期的な予測を行うことができる
    - 機械学習モデルの構築を大幅に簡素化するために，一連の事前定義済みアルゴリズムに加えて，モデルをトレーニングするためのAutoMLオプションを提供

- Amazon Fraud Detector
    - 機械学習による不正検知サービス
    - 学習なしで利用可能（学習済み）で，以下の既存テンプレートから利用を開始できる
        - アカウント作成
        - オンライン決済，など
    - Fraud Detector の予測結果に対して，ルールベースで最終的な不正検知が可能
    - リージョン：バージニア

- Amazon CodeGuru
    - コードレビューの自動化と性能改善のためのガイドを行う開発者向けのサービス
    - CodeGuru Revier
        - コードを静的に解析してくれる（スレッドセーフでないなどの様々な問題を検出する）
    - CodeGuru Profiler
        - 本番環境で継続的に稼働
    - **Javaにしか対応していない**

- Contact Lens for Amazon Connect
    - コンタクトセンターにおける業務をAIで効率化するためのサービス
        - 通話やチャットのセンチメント分析
        - 問い合わせ内容の自動分類
        - 会話が途絶えている状況の自動検出（-> 難しい質問が来ている？）
    - 分析のためのUIを提供
    - 対応言語：米国英語

- AWS Inferentia
    - AWSが設計したチップ
    - 4 Neuron コア
    - 最大 128 TOPS (1秒間に数兆回の演算）
    - 2 段階のメモリ構造（オンチップのCacheとDRAMのメモリ）
    - FP16, BF16, INT8 のデータチップサポート
    - 背景：推論（本番環境）が一番パフォーマンスが要求される -> 推論に力を入れたチップ
    - 留意：一度コードをInferentia用にコンパイルする（コンパイラはAWSが用意済み） => デプロイ => デバッグ／プロファイル

- 機械学習を学ぶためのデバイス
    - 開発者向け機械学習対応ビデオカメラ
    - DeepRacer
    - DeepComposer
        - メロディを入力すると，ジャンルに応じた伴奏を機械学習で生成

## Amazon SageMaker紹介
### SageMakerとは
- 対応していること
    - ラベリング（アノテーション）
    - 開発環境
    - 学習環境
    - 推論環境

### 学習・推論環境をコンテナで素早く構築できる
- 学習用インスタンスで学習をまわす -> 学習済みモデルを推論用インスタンスに取り込み，推論を返す

### SageMakerの各機能の詳細
- Studio（IDE）：AWS Single Sign-OnもしくはAWS IAMでアクセス可能（セキュリティ的には後者のほうがbetterだが，手軽さでは前者）
- Studioから，以下の各機能を呼び出すことができる．（Experimentsはまだ呼び出せないらしい）
    - Ground Truth（ラベリング）
        - Mechanical Turk，クラウドソーシング，プライベートワーカー等へジョブ依頼
        - 組み込みラベリングツール（準備済みのタスク（画像を見てサッカー/バスケを分ける，物体検出，セマンティックセグメンテーション，などのテンプレート））の種類が増えた
    - Amazon SageMaker Notebooks（Jupyter）
        - AWS SSO でのアクセスが可能なノートブック
        - 待ち時間なくワンクリックでノートブックを起動
        - リソースの拡大・縮小はバックエンドで自動的に行われる
        - SSOのアプリケーションにユーザーを登録し共同作業が可能
        - 指定時間内に操作がなければ自動停止するという機能も**追加予定**
        - オハイオリージョンでPreview中
    - SageMaker Experiments（実験管理）
        - SageMaker Experiments SDK
        - 学習を改善するための試行錯誤（実験）の結果を管理する
    - Debugger（デバッグ・分析）
        - 学習時の異常出力等の問題を検出
        - 問題検出のルールがあらかじめ与えられ（追加も可能），S3に出力される学習の途中計算結果（テンソル）からデバッグ
        - TensorFlow, Keras, Apache MXNet, PyTorch, XGBoost に対応
        - SageMakerが使えるすべてのリージョンで提供
        - TensorBoardとの連携も可能
    - Processing
        - 機械学習で必要となるデータの前処理・後処理をバッチで行う
        - 学習・テストデータの一括整形，推論結果からのフィルタリングなど
    - Neo（モデルコンパイル）
    - Model Monitor（性能監視）
        - モデルを監視するものではなく，モデルの（＝推論エンドポイントの）入出力を監視するもの．
            - 学習時に用いたデータをベースにした予測リクエストと実際のリクエストに乖離がないかを評価する．
            - その乖離の有無に判断する偏差（差）はカスタムで定義可能．
        - 出力をS3に自動でアップロードすることもできるので，本番環境を実行しながらA/Bテストを実行できたりする．
    - Augmented AI（人間による性能評価）
        - 推論結果を人間が修正するワークフローを構築する機能
        - Ground Truthと同様，テンプレートを構築してワーカーにレビュー依頼
        - モデルが返した確信度に応じて，ノーレビューで通すか人間のレビューを通すか振り分けられる．
    - Autopilot（一連のワークフローの自動化）
        - テーブルデータに対する予測と分類の機械学習のAutoML機能
        - 不正検知，ユーザ分類（離反予測），レコメンデーションなど多数のユースケースに適用できる
        - データソースと予測対象を指定
        - データの前処理，アルゴリズムの選択，インスタンスタイプ選択なども自動化
        - US4リージョン，東京など16リージョンで利用可能

## その他
### Amazon Aurora Machine Learning
- SQL言語を使用して，データベースに機械学習の予測機能を追加
- Auroraデータベースから，Amazon SageMakerおよびAmazon Comrehendへ統合
- Amazon SageMakerモデルトレーニングのためにAmazon AuroraからデータをS3にエクスポート
- たとえばAuroraでSQLクエリを記述することにより，製品推奨システムを構築できる．クエリは，顧客プロフィール，ショッピング履歴，および製品カタログデータをAmazon SageMakerモデルに渡す．次に，アプリケーションはクエリ結果として返される製品推奨を取得する．
